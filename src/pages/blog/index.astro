---
import Layout from '@/layouts/Layout.astro'
import { getAllPosts, calculateReadTime } from '@/lib/data-utils'
import Blog from '@/components/blog/blog-component/blog-component'

// Get all blog posts
const allPosts = await getAllPosts()

// Transform posts to match the BlogPost type
const blogData = allPosts.map(post => ({
  id: post.data.id,
  slug: post.data.slug,
  title: post.data.title,
  description: post.data.description,
  imageUrl: post.data.imageUrl || '/images/placeholder.jpg',
  imageAlt: post.data.imageAlt || post.data.title,
  pubDate: post.data.pubDate,
  author: post.data.author,
  avatarUrl: post.data.avatarUrl || '/images/avatar-placeholder.jpg',
  category: post.data.category,
  readTime: calculateReadTime(post.body || ''),
  featured: post.data.featured,
  tags: post.data.tags
}))

const pageTitle = 'Blog'
const pageDescription = 'Read our latest articles about web development, Astro, and modern web technologies.'
---

<Layout title={pageTitle} description={pageDescription}>
  <Blog blogData={blogData} client:load />
</Layout>
